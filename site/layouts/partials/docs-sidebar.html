<nav class="pure-menu"  aria-label="Docs navigation">
    {{- $url := split .Permalink "/" -}}
    {{- $page_slug := index $url (sub (len $url) 2) -}}

    <a class="pure-menu-heading" href="#">Docs</a>

    <ul class="pure-menu-list">
        {{- range $group := .Site.Data.sidebar -}}
        {{- $link := $group.title -}}
        {{- $link_slug := $link | urlize -}}

        {{- if $group.pages -}}
        {{- $link = index $group.pages 0 -}}
        {{- $link_slug = $link.title | urlize -}}
        {{- end -}}

        {{- $group_slug := $group.title | urlize -}}
        {{- $is_active_group := eq $.Page.Params.group $group_slug }}

        <li class="pure-menu-item menu-item-divided">
            <a class="pure-menu-link"
               href="#"
               role="button">
                {{ $group.title }}
            </a>

            {{- if $group.pages }}
            <div class="" id="{{ $group_slug }}-collapse">
                <ul class="pure-menu-list">
                    {{- range $doc := $group.pages -}}
                    {{- $doc_slug := $doc.title | urlize -}}
                    {{- $is_active := and $is_active_group (eq $page_slug $doc_slug) -}}
                    {{- $href := printf "/makejack/docs/%s/%s/%s/" $.Site.Params.docs_version $group_slug $doc_slug }}

                    <li class="pure-menu-item{{ if $is_active }} pure-menu-selected{{ end }}">
                        <a href="{{ $href }}"
                           class="pure-menu-link">
                            {{ $doc.title }}
                        </a>
                    </li>
                    {{- end }}
                </ul>
            </div>
            {{- end }}
        </li>
        {{- end }}
    </ul>
</nav>
